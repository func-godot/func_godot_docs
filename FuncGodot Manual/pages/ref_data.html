<!DOCTYPE html>
<html lang="en-US">
<head>
    <title>FuncGodot Manual</title>
    <link rel="icon" type="image/x-icon" href="../images/godot_ranger.svg">
    <link rel="stylesheet" href="styles.css">
</head>
<body class="main">
    <div class="main">
        <h1>FuncGodotData</h1>
        <p>
            FuncGodot utilizes multiple custom data structs to hold information parsed from the map file and read and modified by the 
            other core build classes.
        </p>
        <p>
            All data structs extend from RefCounted, therefore all data is passed by reference.
        </p>

        <h2 id="face">FuncGodot FaceData</h2>
        <p>
            Data struct representing both a single map plane and a mesh face. Generated during parsing by plane definitions in the map file, 
            it is further modified and utilized during the geo generation stage to create the final entity meshes.
        </p>
        <h3>Methods</h3>
        <table class="props">
            <tr class=""header>
                <td>Method</td>
                <td>Description</td>
                <td>Return type</td>
            </tr>
            <tr>
                <td>get_centroid()</td>
                <td></td>
                <td>Vector3</td>
            </tr>
            <tr>
                <td>get_basis()</td>
                <td></td>
                <td>Vector3</td>
            </tr>
            <tr>
                <td>wind()</td>
                <td></td>
                <td>Void</td>
            </tr>
            <tr>
                <td>index_vertices()</td>
                <td></td>
                <td>Void</td>
            </tr>
        </table>
        
        <h3>Properties</h3>
        <table class="props">
            <tr class="header">
                <td>Property</td>
                <td>Type</td>
                <td>Description</td>
            </tr>
            <tr>
                <td>Vertices</td>
                <td>PackedVector3Array</td>
                <td></td>
            </tr>
            <tr>
                <td>Indices</td>
                <td>PackedInt32Array</td>
                <td></td>
            </tr>
            <tr>
                <td>Normals</td>
                <td>PackedVector3Array</td>
                <td></td>
            </tr>
            <tr>
                <td>Tangents</td>
                <td>PackedFloat32Array</td>
                <td></td>
            </tr>
            <tr>
                <td>Texture</td>
                <td>String</td>
                <td>Local path to the texture without the extension, relative to the FuncGodotMap node's settings' base texture directory.</td>
            </tr>
            <tr>
                <td>UV</td>
                <td>Transform2D</td>
                <td>
                    UV transform data generated during the parsing stage. Used for both Standard and Valve 220 UV formats, 
                    though rotation is not applied to the transform when using Valve 220.
                </td>
            </tr>
            <tr>
                <td>UV Axes</td>
                <td>PackedVector3Array</td>
                <td>
                    Raw vector data provided by the Valve 220 format during parsing. It is used to calculate rotations. 
                    The presence of this data determines how face UVs and tangents are calculated.
                </td>
            </tr>
            <tr>
                <td>Plane</td>
                <td>Plane</td>
                <td>Raw plane data parsed from the map file using the id Tech coordinate system.</td>
            </tr>
        </table>

        <br><hr>

        <h2 id="brush">FuncGodotBrushData</h2>
        <p>
            Data struct representing a single map format brush. It is largely meant as a container for face data.
        </p>
        <h3>Properties</h3>
        <table class="props">
            <tr class="header">
                <td>Property</td>
                <td>Type</td>
                <td>Description</td>
            </tr>
            <tr>
                <td>Planes</td>
                <td>Array[Plane]</td>
                <td>Raw plane data parsed from the map file using the id Tech coordinate system.</td>
            </tr>
            <tr>
                <td>Faces</td>
                <td>Array[FuncGodotFaceData]</td>
            </tr>
            <tr>
                <td>Origin</td>
                <td>Bool</td>
                <td>
                    True if this brush is completely covered in the Origin texture defined in the FuncGodotMap node's settings.
                    Determined during the parsing stage and utilized during the geometry generation stage.
                </td>
            </tr>
        </table>

        <br><hr>

        <h2 id="patchdef">FuncGodotPatchData</h2>
        <p>
            Data struct representing a patch def entity.
        </p>
        <h3>Properties</h3>
        <table class="props">
            <tr class="header">
                <td>Property</td>
                <td>Type</td>
                <td>Description</td>
            </tr>
            <tr>
                <td>Texture</td>
                <td>String</td>
                <td>Local path to the texture without the extension, relative to the FuncGodotMap node's settings' base texture directory.</td>
            </tr>
            <tr>
                <td>Size</td>
                <td>PackedInt32Array</td>
                <td></td>
            </tr>
            <tr>
                <td>Points</td>
                <td>PackedVector3Array</td>
                <td></td>
            </tr>
            <tr>
                <td>UVs</td>
                <td>PackedVector2Array</td>
                <td></td>
            </tr>
        </table>

        <br><hr>

        <h2 id="group">FuncGodotGroupData</h2>
        <p>
            Data struct representing a TrenchBroom Group, TrenchBroom Layer, or Valve VisGroup. 
            Generated during the parsing stage and utilized during both parsing and entity assembly stages.
        </p>
        <h3>Properties</h3>
        <table class="props">
            <tr class="header">
                <td>Property</td>
                <td>Type</td>
                <td>Description</td>
            </tr>
            <tr>
                <td>Type</td>
                <td>GroupType</td>
                <td>
                    Defines whether the group is a Group or a Layer. Currently only determines the name of the group.
                    <ul>
                        <li><b>Group : </b> Default group type representing a TrenchBroom Group or a Valve VisGroup.</li>
                        <li><b>Layer : </b> Group type representing a TrenchBroom Layer.</li>
                    </ul><br>
                </td>
            </tr>
            <tr>
                <td>ID</td>
                <td>Int</td>
                <td>
                    Group ID retrieved from the map file. Utilized during the parsing and entity assembly stages to determine 
                    which entities belong to which groups as well as which groups are children of other groups.
                </td>
            </tr>
            <tr>
                <td>Name</td>
                <td>String</td>
                <td>Generated during the parsing stage using the format of type_id_name, eg: group_2_Arkham.</td>
            </tr>
            <tr>
                <td>Parent ID</td>
                <td>Int</td>
                <td>ID of the parent group data, used to determine which group data is this group's parent.</td>
            </tr>
            <tr>
                <td>Parent</td>
                <td>FuncGodotGroupData</td>
                <td>Pointer to another group data that this group is a child of.</td>
            </tr>
            <tr>
                <td>Node</td>
                <td>Node3D</td>
                <td>Pointer to generated Node3D representing this group in the SceneTree.</td>
            </tr>
            <tr>
                <td>Omit</td>
                <td>Bool</td>
                <td>
                    If true, erases all entities assigned to this group and then the group itself at the end of the parsing stage, 
                    preventing those entities from being generated into nodes. 
                    Can be set in TrenchBroom on layers using the "omit layer" option.
                </td>
            </tr>
        </table>

        <br><hr>

        <h2 id="entity">FuncGodotEntityData</h2>
        <p>
            Data struct representing a map format entity.
        </p>
        <h3>Properties</h3>
        <table class="props">
            <tr class="header">
                <td>Property</td>
                <td>Type</td>
                <td>Description</td>
            </tr>
            <tr>
                <td>Properties</td>
                <td>Dictionary</td>
                <td>
                    All of the entity's key value pairs from the map file, retrieved during parsing. The func_godot_properties dictionary generated 
                    at the end of entity assembly is derived from this.
                </td>
            </tr>
            <tr>
                <td>Brushes</td>
                <td>Array[FuncGodotBrushData]</td>
                <td>
                    The entity's brush data collected during the parsing stage. If the entity's FGD resource cannot be found, 
                    the presence of a single brush determines this entity to be a Solid Entity.
                </td>
            </tr>
            <tr>
                <td>Patches</td>
                <td>Array[FuncGodotPatchData]</td>
                <td>
                    The entity's patch def data collected during the parsing stage. If the entity's FGD resource cannot be found, 
                    the presence of a single patch def determines this entity to be a Solid Entity.
                </td>
            </tr>
            <tr>
                <td>Group</td>
                <td>FuncGodotGroupData</td>
                <td>Pointer to the group data this entity belongs to.</td>
            </tr>
            <tr>
                <td>Definition</td>
                <td>FuncGodotFGDEntityClass</td>
                <td>
                    The entity's FGD resource, determined by matching the classname properties of each. 
                    This can only be a <a href="ref_fgd_resources.html#Solid" target="main">FuncGodotFGDSolidClass</a>, 
                    <a href="ref_fgd_resources.html#Point" target="main">FuncGodotFGDPointClass</a>, 
                    or <a href="ref_fgd_resources.html#ModelPoint" target="main">FuncGodotFGDModelPointClass</a>.
                </td>
            </tr>
            <tr>
                <td>Mesh</td>
                <td>ArrayMesh</td>
                <td>Mesh resource generated during the geometry generation stage.</td>
            </tr>
            <tr>
                <td>Mesh Instance</td>
                <td>MeshInstance3D</td>
                <td>MeshInstance3D node generated during the entity assembly stage.</td>
            </tr>
            <tr>
                <td>Mesh Metadata</td>
                <td>Dictionary</td>
                <td>Optional mesh metadata compiled during the geometry generation stage, used to determine face information from collision.</td>
            </tr>
            <tr>
                <td>Shapes</td>
                <td>Array[Shape3D]</td>
                <td></td>
            </tr>
            <tr>
                <td>Collision Shapes</td>
                <td>Array[CollisionShape3D]</td>
                <td>A collection of <i>CollisionShape3D</i> nodes generated during the entity assembly stage. Each node corresponds to a shape in the <i>shapes</i> array.</td>
            </tr>
            <tr>
                <td>Occluder Instance</td>
                <td>OccluderInstance3D</td>
                <td><i>OccluderInstance3D</i> node generated during the entity assembly stage using the <i>mesh</i> resource.</td>
            </tr>
            <tr>
                <td>Origin</td>
                <td>Vector3</td>
                <td>True global position of the entity's generated node that the mesh's vertices are offset by during the geometry generation stage.</td>
            </tr>
        </table>

        <h3>Methods</h3>
        <table class="props">
            <tr class="header">
                <td>Method</td>
                <td>Description</td>
                <td>Return type</td>
            </tr>
            <tr>
                <td>is_convex()</td>
                <td>Checks the entity's FGD resource definition, returning whether the Solid Class CollisionShapeType is set to Convex.</td>
                <td>Bool</td>
            </tr>
            <tr>
                <td>is_concave()</td>
                <td>Checks the entity's FGD resource definition, returning whether the Solid Class CollisionShapeType is set to Concave.</td>
                <td>Bool</td>
            </tr>
            <tr>
                <td>is_smooth_shaded(smoothing_property: String = "_phong")</td>
                <td>
                    Determines if the entity's mesh should be processed for face smoothing. 
                    The smoothing property can be retrieved from the map node's settings.
                </td>
                <td>Bool</td>
            </tr>
            <tr>
                <td>get_smoothing_angle(smoothing_angle_property: String = "_phong_angle")</td>
                <td>
                    Retrieves the entity's smoothing angle to determine if the face should be smoothed. 
                    The smoothing angle property can be retrieved from the map node's settings.
                </td>
                <td>Float</td>
            </tr>
        </table>
    </div>
    <br><br><br>
</body>
</html>